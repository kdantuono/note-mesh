<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoteMesh - Shared Notes Platform</title>
    <meta name="description" content="NoteMesh is a collaborative note-taking platform for creating, sharing, and managing notes with other users.">
    <link rel="stylesheet" href="css/styles.css?v=2.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Skip to main content for screen readers -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-sticky-note" aria-hidden="true"></i>
                <span>NoteMesh</span>
            </div>
            <div class="nav-menu" id="navMenu">
                <div class="nav-links" id="navLinks" role="menubar">
                    <a href="#" class="nav-link" id="dashboardLink" role="menuitem">Dashboard</a>
                    <a href="#" class="nav-link" id="createNoteLink" role="menuitem">New Note</a>
                    <a href="#" class="nav-link" id="profileLink" role="menuitem">Profile</a>
                    <a href="#" class="nav-link" id="logoutLink" role="menuitem">Logout</a>
                </div>
                <div class="user-info" id="userInfo" role="status" aria-live="polite">
                    <span id="currentUser">Guest</span>
                </div>
            </div>
            <button class="nav-toggle" id="navToggle" aria-expanded="false" aria-controls="navMenu" aria-label="Toggle navigation menu">
                <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
        </div>
    </nav>

    <main class="main-content" id="main-content" role="main">
        <!-- Login/Register Section -->
        <section id="authSection" class="auth-section" aria-labelledby="authTitle">
            <div class="auth-container">
                <div class="auth-card">
                    <div class="auth-header">
                        <h2 id="authTitle">Login to NoteMesh</h2>
                        <p id="authSubtitle">Manage and share your notes securely</p>
                    </div>

                    <!-- Login Form -->
                    <form id="loginForm" class="auth-form" aria-labelledby="authTitle" novalidate>
                        <div class="form-group">
                            <label for="loginUsername">Username</label>
                            <input type="text" id="loginUsername" name="username" required
                                   aria-describedby="loginUsernameError" autocomplete="username">
                            <div id="loginUsernameError" class="error-message" aria-live="polite"></div>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" name="password" required
                                   aria-describedby="loginPasswordError" autocomplete="current-password">
                            <div id="loginPasswordError" class="error-message" aria-live="polite"></div>
                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                        <p class="auth-switch">
                            Don't have an account?
                            <a href="#" id="showRegister">Register here</a>
                        </p>
                    </form>

                    <!-- Register Form -->
                    <form id="registerForm" class="auth-form hidden">
                        <div class="form-group">
                            <label for="registerUsername">Username</label>
                            <input type="text" id="registerUsername" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="registerEmail">Email</label>
                            <input type="email" id="registerEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="registerFullName">Full Name</label>
                            <input type="text" id="registerFullName" name="full_name" required>
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">Password</label>
                            <input type="password" id="registerPassword" name="password" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" name="confirm_password" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                        <p class="auth-switch">
                            Already have an account?
                            <a href="#" id="showLogin">Login here</a>
                        </p>
                    </form>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboardSection" class="dashboard-section hidden">
            <div class="dashboard-container">
                <!-- Search and Filter -->
                <div class="search-section">
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Search notes by title or content...">
                        <button id="searchBtn" class="btn btn-secondary">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="filter-section">
                        <div class="filter-group">
                            <label for="tagFilter">Filter by Tags:</label>
                            <input type="text" id="tagFilter" placeholder="Enter tag name">
                        </div>
                        <div class="filter-group">
                            <label for="ownerFilter">Show:</label>
                            <select id="ownerFilter">
                                <option value="all">All Notes</option>
                                <option value="owned">My Notes</option>
                                <option value="shared_with_me">Shared with Me</option>
                                <option value="shared_by_me">Shared by Me</option>
                            </select>
                        </div>
                        <button id="clearFilters" class="btn btn-outline">Clear Filters</button>
                    </div>
                </div>

                <!-- Notes List -->
                <div class="notes-section">
                    <div class="notes-header">
                        <h2>Your Notes</h2>
                        <button id="newNoteBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> New Note
                        </button>
                    </div>
                    <div class="notes-grid" id="notesGrid">
                        <!-- Notes will be populated here -->
                    </div>
                    <div class="pagination" id="pagination">
                        <!-- Pagination will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Note Detail Section -->
        <section id="noteDetailSection" class="note-detail-section hidden">
            <div class="note-detail-container">
                <div class="note-detail-header">
                    <button id="backToNotes" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Notes
                    </button>
                    <div class="note-actions">
                        <button id="editNoteBtn" class="btn btn-outline">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button id="shareNoteBtn" class="btn btn-primary">
                            <i class="fas fa-share"></i> Share
                        </button>
                        <button id="deleteNoteBtn" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                <div class="note-detail-content">
                    <h1 id="noteTitle"></h1>
                    <div class="note-meta">
                        <span id="noteOwner"></span>
                        <span id="noteDate"></span>
                        <span id="noteViews"></span>
                    </div>
                    <div class="note-tags" id="noteTags">
                        <!-- Tags will be populated here -->
                    </div>
                    <div class="note-content" id="noteContent">
                        <!-- Content will be populated here -->
                    </div>
                    <div class="note-hyperlinks" id="noteHyperlinks">
                        <!-- Hyperlinks will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Create/Edit Note Section -->
        <section id="noteEditorSection" class="note-editor-section hidden">
            <div class="note-editor-container">
                <div class="editor-header">
                    <h2 id="editorTitle">Create New Note</h2>
                    <button id="cancelEdit" class="btn btn-secondary">Cancel</button>
                </div>
                <form id="noteForm" class="note-form">
                    <div class="form-group">
                        <label for="noteTitleInput">Title</label>
                        <input type="text" id="noteTitleInput" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="noteContentInput">Content</label>
                        <textarea id="noteContentInput" name="content" rows="12" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="noteTagsInput">Tags (comma-separated)</label>
                        <input type="text" id="noteTagsInput" name="tags" placeholder="work, important, project">
                    </div>
                    <div class="form-group">
                        <label for="shareUsernameInput">Share with User (optional) - Read Only Access</label>
                        <div class="share-input-container">
                            <input type="text" id="shareUsernameInput" placeholder="Enter username and press Enter to add (read-only access)">
                        </div>
                        <div class="shared-users-tags" id="sharedUsersTags">
                            <!-- Added users will appear here as removable tags -->
                        </div>

                        <!-- Existing shares (for editing) -->
                        <div id="existingShares" class="existing-shares-section" style="display: none;">
                            <label>Currently Shared With:</label>
                            <div id="existingSharesList" class="existing-shares-list">
                                <!-- Existing shares will appear here -->
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="isPinnedInput" name="is_pinned">
                            Pin this note
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Note
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Share Note Modal -->
        <div id="shareModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Share Note</h3>
                    <button id="closeShareModal" class="modal-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="shareWithUser">Share with User:</label>
                        <input type="text" id="shareWithUser" placeholder="Enter username">
                        <button id="addShareUser" class="btn btn-secondary">Add</button>
                    </div>
                    <div class="form-group">
                        <label>Permission Level:</label>
                        <select id="sharePermission">
                            <option value="read">Read Only</option>
                            <option value="write">Read & Write</option>
                        </select>
                    </div>
                    <div class="shared-users" id="sharedUsers">
                        <!-- Shared users list will be populated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="confirmShare" class="btn btn-primary">Share Note</button>
                    <button id="cancelShare" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner hidden">
        <i class="fas fa-spinner fa-spin"></i>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts with cache busting -->
    <script src="js/config.js?v=2.0"></script>
    <script src="js/debug.js?v=2.0"></script>
    <script src="js/auth.js?v=2.0"></script>
    <script src="js/api.js?v=2.0"></script>
    <script src="js/notes.js?v=2.0"></script>
    <script src="js/ui.js?v=2.0"></script>
    <script src="js/app.js?v=2.0"></script>
</body>
</html>